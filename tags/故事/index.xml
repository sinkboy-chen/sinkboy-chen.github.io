<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>故事 on Sinkboy</title>
        <link>https://sinkboy-chen.github.io/tags/%E6%95%85%E4%BA%8B/</link>
        <description>Recent content in 故事 on Sinkboy</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-tw</language>
        <lastBuildDate>Fri, 27 Oct 2023 00:00:00 +0000</lastBuildDate><atom:link href="https://sinkboy-chen.github.io/tags/%E6%95%85%E4%BA%8B/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Cracking Game Room Password</title>
        <link>https://sinkboy-chen.github.io/p/cracking-game-room-password/</link>
        <pubDate>Fri, 27 Oct 2023 00:00:00 +0000</pubDate>
        
        <guid>https://sinkboy-chen.github.io/p/cracking-game-room-password/</guid>
        <description>&lt;img src="https://sinkboy-chen.github.io/p/cracking-game-room-password/hacker_baby0.jpg" alt="Featured image of post Cracking Game Room Password" /&gt;&lt;div class=&#34;success-box&#34;&gt;
    以下漏洞在第一時間回報並已修復。
&lt;/div&gt;
&lt;p&gt;其實這只是用暴力破解的。但這是我第一次找到漏洞，我想記錄下來。&lt;/p&gt;
&lt;h3 id=&#34;前情提要&#34;&gt;前情提要&lt;/h3&gt;
&lt;p&gt;我高二時正逢新冠疫情，學校改成線上上課。我跟同學們會在老師留下來的會議教室玩你畫我猜。但我玩的不夠盡興，因此去下載了線上桌遊手遊。&lt;/p&gt;
&lt;p&gt;那個手遊中，有可以用4位數密碼鎖起來的私人房間。可以嘗試無限多次密碼，但使用者介面會有些停頓。我想：如果直接從遊戲背後運作的程式下手，是不是可以避開使用者介面的停頓，快速的嘗試所有4位數組合、找到密碼?&lt;/p&gt;
&lt;h3 id=&#34;尋找工具&#34;&gt;尋找工具&lt;/h3&gt;
&lt;p&gt;我的目標明確，要了解這個遊戲：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;怎麼讓手機跟伺服器連線&lt;/li&gt;
&lt;li&gt;怎麼尋問伺服器輸入的密碼是否正確&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;我找到了&lt;a class=&#34;link&#34; href=&#34;https://play.google.com/store/apps/details?id=app.greyshirts.sslcapture&amp;amp;hl=en_US&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;攔截網路封包的工具&lt;/a&gt;。透過這個工具，可以看到各個app向網路傳送的資料。&lt;/p&gt;
&lt;h3 id=&#34;分析網路封包&#34;&gt;分析網路封包&lt;/h3&gt;
&lt;p&gt;當我嘗試遊戲房間密碼時，那個app攔截遊戲與伺服器溝通的網路封包。在一大堆亂碼中，我找到了一筆顯示我嘗試的密碼&amp;quot;0000&amp;quot;及&amp;quot;密碼不正確&amp;quot;。我讓該封包以hex呈現並開始分析。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sinkboy-chen.github.io/p/cracking-game-room-password/network1.png&#34;
	width=&#34;1080&#34;
	height=&#34;1705&#34;
	
	loading=&#34;lazy&#34;
	
		alt=&#34;其中幾筆資料&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;63&#34;
		data-flex-basis=&#34;152px&#34;
	
&gt; &lt;img src=&#34;https://sinkboy-chen.github.io/p/cracking-game-room-password/network3.jpg&#34;
	width=&#34;1080&#34;
	height=&#34;1885&#34;
	
	loading=&#34;lazy&#34;
	
		alt=&#34;嘗試的密碼為0000&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;57&#34;
		data-flex-basis=&#34;137px&#34;
	
&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;前面說過這是疫情期間嘛。當我研究正起勁時，隔天開始要回學校實體上課。早上我在擠滿人的公車去上學，一邊看著一串亂碼。我從第三人稱視角想像自己，覺得自己超帥的，完全有駭客的感覺。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;回到正題，當我漸漸絕望時，我看出了一些意義：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;該封包的第一筆資料類似打招呼。遊戲從我的手機向伺服器傳送id和password。如果正確，伺服器會回傳&amp;quot;ok&amp;quot;。&lt;/li&gt;
&lt;li&gt;每則訊息開頭前8個數字是訊息的長度。&lt;/li&gt;
&lt;li&gt;第二行前8個數字是時間。&lt;/li&gt;
&lt;li&gt;&amp;hellip;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://sinkboy-chen.github.io/p/cracking-game-room-password/network7.jpg&#34;
	width=&#34;1080&#34;
	height=&#34;558&#34;
	
	loading=&#34;lazy&#34;
	
		alt=&#34;試著分析遊戲與伺服器間的協議&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;193&#34;
		data-flex-basis=&#34;464px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;exploitpcracking-game-room-password-exploit&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://sinkboy-chen.github.io/p/cracking-game-room-password-exploit/&#34; &gt;exploit&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;從攔截到的網路封包得知遊戲以ssl與伺服器連線。用&lt;a class=&#34;link&#34; href=&#34;https://docs.python.org/3/howto/sockets.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Python Sockets&lt;/a&gt;向伺服器詢問密碼是否正確最多10000次就成功啦。&lt;/p&gt;
&lt;hr&gt;
</description>
        </item>
        
    </channel>
</rss>
